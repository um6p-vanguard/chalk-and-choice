{% extends "base.html" %}
{% block content %}
<div class="card">
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
    <h2 style="margin:0;">Proficiency Exercises</h2>
    <div class="row">
      <a href="{{ url_for('proficiency_config') }}" class="btn">‚öôÔ∏è Settings</a>
      <a href="{{ url_for('proficiency_reviews') }}" class="btn">üìã Reviews</a>
      <a href="{{ url_for('proficiency_exercises_new') }}" class="btn btn-primary">+ New Exercise</a>
    </div>
  </div>

  <div style="background:#1f2937; padding:14px; border-radius:10px; margin-bottom:20px;">
    <div class="row" style="gap:20px;">
      <div>
        <span class="muted">Test Configuration:</span>
        <strong>{{ config.title }}</strong>
      </div>
      <div>
        <span class="muted">Exercises per test:</span>
        <strong>{{ config.exercise_count }}</strong>
      </div>
      <div>
        <span class="muted">Duration:</span>
        <strong>{{ config.duration_minutes }} min</strong>
      </div>
      <div>
        <span class="muted">Cooldown:</span>
        <strong>{{ config.cooldown_hours }} hours</strong>
      </div>
      <div>
        <span class="muted">Status:</span>
        {% if config.is_active %}
          <strong style="color:#4ade80;">Active</strong>
        {% else %}
          <strong style="color:var(--danger);">Disabled</strong>
        {% endif %}
      </div>
    </div>
  </div>

  {% if exercises %}
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Learning Outcome</th>
        <th>Difficulty</th>
        <th>Visible Tests</th>
        <th>Hidden Tests</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for ex in exercises %}
      <tr>
        <td><strong>{{ ex.title }}</strong></td>
        <td>
          {% if ex.outcome_tag %}
            <span style="background:#1f2937; padding:4px 8px; border-radius:4px; font-size:0.85rem;">{{ ex.outcome_tag }}</span>
          {% else %}
            <span class="muted" style="font-size:0.85rem;">Not tagged</span>
          {% endif %}
        </td>
        <td>
          {% if ex.difficulty_level %}
            <span style="color:var(--brand);">{{ '‚≠ê' * ex.difficulty_level }}</span>
          {% else %}
            <span class="muted">‚Äî</span>
          {% endif %}
        </td>
        <td>{{ ex.visible_test_cases|length }}</td>
        <td>{{ ex.hidden_test_cases|length }}</td>
        <td>
          {% if ex.is_active %}
            <span style="color:#4ade80;">Active</span>
          {% else %}
            <span class="muted">Inactive</span>
          {% endif %}
        </td>
        <td>
          <a href="{{ url_for('proficiency_exercises_edit', exercise_id=ex.id) }}" class="btn" style="padding:6px 10px;">Edit</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p class="muted">No exercises yet. Create your first exercise and tag it with a learning outcome to build outcome-specific test pools.</p>
  {% endif %}
</div>
{% endblock %}
