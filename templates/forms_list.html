{% extends "base.html" %}
{% block content %}
<div class="card">
  <h3>Forms</h3>
  <p><a class="btn btn-primary" href="{{ url_for('forms_new') }}">New Form</a></p>
  {% if forms %}
    <table>
      <thead><tr><th>Title</th><th>Code</th><th>Created</th><th>Actions</th></tr></thead>
      <tbody>
        {% for f in forms %}
          <tr>
            <td><a href="{{ url_for('forms_results', code=f.code) }}">{{ f.title }}</a></td>
            <td class="muted">{{ f.code }}</td>
            <td>
              <a class="btn" href="{{ url_for('form_render', code=f.code) }}">Open</a>
              <button class="btn"
                      onclick="navigator.clipboard.writeText('{{ request.url_root.rstrip('/') }}{{ url_for('form_render', code=f.code) }}')">
                Copy link
              </button>
              <a class="btn" href="{{ url_for('forms_qr_page', code=f.code) }}">QR</a>
            
              {% if f.is_open %}
                <form method="post" action="{{ url_for('forms_close', code=f.code) }}" style="display:inline;">
                  <input type="hidden" name="csrf" value="{{ csrf_token() }}">
                  <button class="btn btn-danger" type="submit">Close</button>
                </form>
              {% else %}
                <form method="post" action="{{ url_for('forms_open', code=f.code) }}" style="display:inline;">
                  <input type="hidden" name="csrf" value="{{ csrf_token() }}">
                  <button class="btn" type="submit">Open</button>
                </form>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
        </tbody>        
    </table>
  {% else %}
    <p class="muted">No forms yet.</p>
  {% endif %}
</div>
{% endblock %}
