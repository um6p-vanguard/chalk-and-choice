{% extends "base.html" %}
{% block content %}
<div class="card">
  <h3 style="margin:0;">{{ leaderboard.title }}</h3>
  <p class="muted" style="margin:6px 0 0 0;">
    {{ metrics[leaderboard.metric].label if leaderboard.metric in metrics else leaderboard.metric }} •
    {{ leaderboard.group.name if leaderboard.group else "All students" }} •
    {{ "Published" if leaderboard.is_published else "Draft (visible only to staff)" }}
  </p>
  {% if leaderboard.metric in metrics and metrics[leaderboard.metric].description %}
    <p class="muted" style="margin:6px 0 0 0;">{{ metrics[leaderboard.metric].description }}</p>
  {% endif %}
  <div class="row" style="gap:10px; margin-top:10px;">
    <a class="btn" href="{{ url_for('leaderboards_public') }}">Back to leaderboards</a>
    {% if user %}
      <a class="btn" href="{{ url_for('leaderboards_admin') }}">Manage leaderboards</a>
    {% endif %}
  </div>
</div>

<div class="sp"></div>

<div class="card">
  {% if rows %}
    <table>
      <thead>
        <tr>
          <th style="width:70px;">Rank</th>
          <th>Student</th>
          <th style="text-align:right;">Value</th>
        </tr>
      </thead>
      <tbody>
        {% for row in rows %}
          <tr>
            <td>#{{ row.rank }}</td>
            <td>{{ row.student.name if row.student else "Student removed" }}</td>
            <td style="text-align:right;">
              {% if leaderboard.metric == "logtime" %}
                {{ "%.1f"|format((row.value or 0) / 60) }} min
              {% elif leaderboard.metric == "total_points" %}
                {{ "%.2f"|format(row.value or 0) }}
              {% else %}
                {{ row.value|int }}
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="muted" style="margin:0;">No students matched this leaderboard yet.</p>
  {% endif %}
</div>
{% endblock %}
