{% extends "base.html" %}{% extends "base.html" %}



{% block content %}{% block content %}

<div style="max-width: 900px; margin: 0 auto; padding: 20px;"><div style="max-width: 900px; margin: 0 auto; padding: 20px;">

  <div style="margin-bottom: 30px;">  <div style="margin-bottom: 30px;">

    <a href="/exercises/{{ exercise_set.code }}/edit" style="color: #60a5fa; text-decoration: none;">‚Üê Back to Exercise Set</a>    <a href="/exercises/{{ exercise_set.code }}/edit" style="color: #60a5fa; text-decoration: none;">‚Üê Back to Exercise Set</a>

    <h1 style="margin: 10px 0;">Edit Exercise #{{ exercise.order }}</h1>    <h1 style="margin: 10px 0;">Edit Exercise #{{ exercise.order }}</h1>

  </div>  </div>

    

  {% if error %}  {% if error %}

  <div style="background: rgba(239,68,68,0.2); border: 1px solid #ef4444; padding: 15px; border-radius: 8px; margin-bottom: 20px; color: #fca5a5;">  <div style="background: rgba(239,68,68,0.2); border: 1px solid #ef4444; padding: 15px; border-radius: 8px; margin-bottom: 20px; color: #fca5a5;">

    {{ error }}    {{ error }}

  </div>  </div>

  {% endif %}  {% endif %}

    

  <form method="POST" action="/exercises/{{ exercise_set.code }}/{{ exercise.order }}/edit-exercise" style="display: flex; flex-direction: column; gap: 20px;">  <form method="POST" action="/exercises/{{ exercise_set.code }}/{{ exercise.order }}/edit-exercise" style="display: flex; flex-direction: column; gap: 20px;">

    <input type="hidden" name="csrf" value="{{ csrf_token() }}">    <input type="hidden" name="csrf" value="{{ csrf_token() }}">

        

    <div>    <div>

      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Title *</label>      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Title *</label>

      <input type="text" name="title" value="{{ exercise.title }}" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">      <input type="text" name="title" value="{{ exercise.title }}" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">

    </div>    </div>

        

    <div>    <div>

      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Description (Markdown) *</label>      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Description (Markdown) *</label>

      <textarea name="description" rows="8" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white; font-family: monospace;">{{ exercise.description }}</textarea>      <textarea name="description" rows="8" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white; font-family: monospace;">{{ exercise.description }}</textarea>

    </div>    </div>

        

    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">

      <div>      <div>

        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Difficulty *</label>        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Difficulty *</label>

        <select name="difficulty" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">        <select name="difficulty" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">

          <option value="easy" {% if exercise.difficulty == 'easy' %}selected{% endif %}>Easy</option>          <option value="easy" {% if exercise.difficulty == 'easy' %}selected{% endif %}>Easy</option>

          <option value="medium" {% if exercise.difficulty == 'medium' %}selected{% endif %}>Medium</option>          <option value="medium" {% if exercise.difficulty == 'medium' %}selected{% endif %}>Medium</option>

          <option value="hard" {% if exercise.difficulty == 'hard' %}selected{% endif %}>Hard</option>          <option value="hard" {% if exercise.difficulty == 'hard' %}selected{% endif %}>Hard</option>

        </select>        </select>

      </div>      </div>

            

      <div>      <div>

        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Category</label>        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Category</label>

        <input type="text" name="category" value="{{ exercise.category or '' }}" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">        <input type="text" name="category" value="{{ exercise.category or '' }}" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">

      </div>      </div>

            

      <div>      <div>

        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Points *</label>        <label style="display: block; margin-bottom: 8px; font-weight: 600;">Points *</label>

        <input type="number" name="points" value="{{ exercise.points }}" min="1" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">        <input type="number" name="points" value="{{ exercise.points }}" min="1" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white;">

      </div>      </div>

    </div>    </div>

        

    <div>    <div>

      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Starter Code *</label>      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Starter Code *</label>

      <textarea name="starter_code" rows="12" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white; font-family: 'Courier New', monospace;">{{ exercise.starter_code }}</textarea>      <textarea name="starter_code" rows="12" required style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white; font-family: 'Courier New', monospace;">{{ exercise.starter_code }}</textarea>

    </div>    </div>

        

    <div>    <div>

      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Default Input</label>      <label style="display: block; margin-bottom: 8px; font-weight: 600;">Default Input</label>

      <textarea name="default_input" rows="4" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white; font-family: 'Courier New', monospace;">{{ exercise.default_input or '' }}</textarea>      <textarea name="default_input" rows="4" style="width: 100%; padding: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: white; font-family: 'Courier New', monospace;">{{ exercise.default_input or '' }}</textarea>

    </div>    </div>

        

    <fieldset style="border: 1px solid rgba(96,165,250,0.3); border-radius: 8px; padding: 20px; background: rgba(96,165,250,0.05);">    <fieldset style="border: 1px solid rgba(96,165,250,0.3); border-radius: 8px; padding: 20px; background: rgba(96,165,250,0.05);">

      <legend style="padding: 0 10px; color: #60a5fa; font-weight: 600;">üß™ Test Cases</legend>      <legend style="padding: 0 10px; color: #60a5fa; font-weight: 600;">üß™ Test Cases</legend>

            

      <div id="test-cases">      <div id="test-cases">

        {% if test_cases %}        {% if test_cases %}

        {% for test in test_cases %}        {% for test in test_cases %}

        <div class="test-case" style="border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px; background: rgba(0,0,0,0.2);">        <div class="test-case" style="border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px; background: rgba(0,0,0,0.2);">

          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">

            <strong>Test Case {{ loop.index }}</strong>            <strong>Test Case {{ loop.index }}</strong>

            <button type="button" onclick="removeTestCase(this)" style="background: #ef4444; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer;">Remove</button>            <button type="button" onclick="removeTestCase(this)" style="background: #ef4444; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer;">Remove</button>

          </div>          </div>

                    

          <div style="margin-bottom: 10px;">          <div style="margin-bottom: 10px;">

            <label style="display: block; margin-bottom: 5px;">Input</label>            <label style="display: block; margin-bottom: 5px;">Input</label>

            <textarea name="test_input[]" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;">{{ test.input }}</textarea>            <textarea name="test_input[]" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;">{{ test.input }}</textarea>

          </div>          </div>

                    

          <div style="margin-bottom: 10px;">          <div style="margin-bottom: 10px;">

            <label style="display: block; margin-bottom: 5px;">Expected Output</label>            <label style="display: block; margin-bottom: 5px;">Expected Output</label>

            <textarea name="test_output[]" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;">{{ test.expected_output }}</textarea>            <textarea name="test_output[]" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;">{{ test.expected_output }}</textarea>

          </div>          </div>

                    

          <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px;">          <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px;">

            <div>            <div>

              <label style="display: block; margin-bottom: 5px;">Description</label>              <label style="display: block; margin-bottom: 5px;">Description</label>

              <input type="text" name="test_description[]" value="{{ test.description or '' }}" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white;">              <input type="text" name="test_desc_{{ loop.index0 }}" value="{{ test.description or '' }}" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white;">

            </div>            </div>

                        

            <div style="display: flex; align-items: flex-end;">            <div style="display: flex; align-items: flex-end;">

              <label style="display: flex; align-items: center; gap: 8px;">              <label style="display: flex; align-items: center; gap: 8px;">

                <input type="checkbox" name="test_hidden[]" value="{{ loop.index0 }}" {% if test.hidden %}checked{% endif %}>                <input type="checkbox" name="test_hidden_{{ loop.index0 }}" value="1" {% if test.hidden %}checked{% endif %}>

                <span>Hidden Test</span>                <span>Hidden Test</span>

              </label>              </label>

            </div>            </div>

          </div>          </div>

        </div>        </div>

        {% endfor %}        {% endfor %}

        {% endif %}      </div>

      </div>      

            <button type="button" onclick="addTestCase()" style="background: #2563eb; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-top: 10px;">

      <button type="button" onclick="addTestCase()" style="background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-top: 10px;">        + Add Test Case

        + Add Test Case      </button>

      </button>      

    </fieldset>      <input type="hidden" id="test-count" name="test_count" value="{{ exercise.test_cases_json|length }}">

        </fieldset>

    <div style="display: flex; gap: 10px; justify-content: flex-end;">    

      <a href="/exercises/{{ exercise_set.code }}/edit" style="background: #475569; color: white; text-decoration: none; padding: 12px 24px; border-radius: 8px;">Cancel</a>    <div style="display: flex; gap: 10px; justify-content: flex-end;">

      <button type="submit" style="background: #10b981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">Save Changes</button>      <a href="/exercises/manage" style="background: #475569; color: white; text-decoration: none; padding: 12px 24px; border-radius: 8px;">Cancel</a>

    </div>      <button type="submit" style="background: #10b981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600;">Save Changes</button>

  </form>    </div>

</div>  </form>

</div>

<script>

let testCaseCount = {{ test_cases|length if test_cases else 0 }};<script>

let testCaseCount = {{ exercise.test_cases_json|length }};

function addTestCase() {

  const container = document.getElementById('test-cases');function addTestCase() {

    const container = document.getElementById('test-cases');

  const testDiv = document.createElement('div');  const testNum = testCaseCount;

  testDiv.className = 'test-case';  

  testDiv.style.cssText = 'border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px; background: rgba(0,0,0,0.2);';  const testDiv = document.createElement('div');

    testDiv.style.cssText = 'border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; margin-bottom: 15px; background: rgba(0,0,0,0.2);';

  testDiv.innerHTML = `  testDiv.id = `test-${testNum}`;

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">  

      <strong>Test Case ${testCaseCount + 1}</strong>  testDiv.innerHTML = `

      <button type="button" onclick="removeTestCase(this)" style="background: #ef4444; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer;">Remove</button>    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">

    </div>      <strong>Test Case ${testNum + 1}</strong>

          <button type="button" onclick="removeTestCase(${testNum})" style="background: #ef4444; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer;">Remove</button>

    <div style="margin-bottom: 10px;">    </div>

      <label style="display: block; margin-bottom: 5px;">Input</label>    

      <textarea name="test_input[]" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;"></textarea>    <div style="margin-bottom: 10px;">

    </div>      <label style="display: block; margin-bottom: 5px;">Input</label>

          <textarea name="test_input_${testNum}" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;"></textarea>

    <div style="margin-bottom: 10px;">    </div>

      <label style="display: block; margin-bottom: 5px;">Expected Output</label>    

      <textarea name="test_output[]" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;"></textarea>    <div style="margin-bottom: 10px;">

    </div>      <label style="display: block; margin-bottom: 5px;">Expected Output</label>

          <textarea name="test_expected_${testNum}" rows="3" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white; font-family: monospace;"></textarea>

    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px;">    </div>

      <div>    

        <label style="display: block; margin-bottom: 5px;">Description</label>    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px;">

        <input type="text" name="test_description[]" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white;">      <div>

      </div>        <label style="display: block; margin-bottom: 5px;">Description</label>

              <input type="text" name="test_desc_${testNum}" style="width: 100%; padding: 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: white;">

      <div style="display: flex; align-items: flex-end;">      </div>

        <label style="display: flex; align-items: center; gap: 8px;">      

          <input type="checkbox" name="test_hidden[]" value="${testCaseCount}">      <div style="display: flex; align-items: flex-end;">

          <span>Hidden Test</span>        <label style="display: flex; align-items: center; gap: 8px;">

        </label>          <input type="checkbox" name="test_hidden_${testNum}" value="1">

      </div>          <span>Hidden Test</span>

    </div>        </label>

  `;      </div>

      </div>

  container.appendChild(testDiv);  `;

  testCaseCount++;  

}  container.appendChild(testDiv);

  testCaseCount++;

function removeTestCase(button) {  document.getElementById('test-count').value = testCaseCount;

  const testDiv = button.closest('.test-case');}

  if (testDiv) {

    testDiv.remove();function removeTestCase(num) {

  }  const testDiv = document.getElementById(`test-${num}`);

}  if (testDiv) {

</script>    testDiv.remove();

{% endblock %}  }

}
</script>
{% endblock %}
